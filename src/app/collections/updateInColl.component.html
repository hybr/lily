<div class="lns_loading" *ngIf="!(docOfCocs | async)">Loading add form...</div>
<md-card *ngIf="(docOfCocs | async)">
  <md-card-header>
    <md-card-title><h2>Adding New {{(docOfCocs|async)?.name}} Record</h2></md-card-title>
    <md-card-subtitle>{{(docOfCocs|async)?.detail}}</md-card-subtitle>
  </md-card-header>

  <md-card-content>
    <form 
      [formGroup]="docForm" 
      novalidate  
      (ngSubmit)="onSubmit(docForm)" 
      [hidden]="submitted"
    >
      <table><!-- all fields -->
        <tr><td><!-- all fields -->
          <md-slide-toggle formControlName="active">Status</md-slide-toggle>
        </td></tr><!-- all fields -->

        <tr *ngFor="let field of fields[0]"><td><!-- all fields -->

          <span *ngIf="(field['name'] != 'active')"><!-- fields to ignore -->
          <span *ngIf="(field['type'] != 'fields')"><!-- main fields -->
            <md-input-container *ngIf="(field['type'] == 'string')">
              <input 
              mdInput  
              placeholder="{{field['title']}}" 
              type="text" 
              formControlName="{{field['name']}}"
              id="addInCollField{{field['name']}}Id"
              />
            </md-input-container>

            <md-input-container *ngIf="(field['type'] == 'number')">
              <input 
              mdInput  
              placeholder="{{field['title']}}" 
              type="number" 
              formControlName="{{field['name']}}"
              id="addInCollField{{field['name']}}Id"
              />
            </md-input-container>

            <md-input-container *ngIf="(field['type'] == 'date')">
              <input 
              mdInput  
              placeholder="{{field['title']}}" 
              type="date" 
              formControlName="{{field['name']}}"
              id="addInCollField{{field['name']}}Id"
              />
            </md-input-container>
          </span><!-- main fields -->

          <table *ngIf="(field['type'] == 'fields')"><!-- show sub fields -->

            <tr><td><!-- show sub fields -->
              {{field['title']}}
            </td></tr><!-- show sub fields -->

            <tr><td><!-- show sub fields -->
                <table formArrayName="{{field['name']}}">
                  <tr *ngFor="let singleSubRecord of docForm['controls'][field['name']]['controls']; let i = index; "><td>
                    <div [formGroupName]="i" class="lns_sub_fields_border"><!-- [formGroupName]="i" -->

                      <div><!--  remove button -->
                        <button md-raised-button (click)="removeSubFieldL1(i, field['name'])">
                          Remove {{i + 1}}
                        </button>
                      </div><!-- remove button -->

                        <md-list>
                          <md-list-item *ngFor="let subField of field['value']" ><!-- each sub field -->
                            <md-input-container md-line *ngIf="(subField['type'] == 'string')">
                              <input 
                                mdInput 
                                placeholder="{{subField['title']}}" 
                                type="text" 
                                formControlName="{{subField['name']}}"
                                id="addInCollField{{subField['name']}}Id"
                              />
                            </md-input-container>

                            <md-input-container md-line *ngIf="(subField['type'] == 'number')">
                              <input 
                                mdInput  
                                placeholder="{{subField['title']}}" 
                                type="number" 
                                formControlName="{{subField['name']}}"
                                id="addInCollField{{subField['name']}}Id"
                              />
                            </md-input-container>

                            <md-input-container md-line *ngIf="(subField['type'] == 'date')">
                              <input 
                                mdInput   
                                placeholder="{{subField['title']}}" 
                                type="date" 
                                formControlName="{{subField['name']}}"
                                id="addInColmdInput lField{{subField['name']}}Id"
                              />
                            </md-input-container>
                          </md-list-item><!-- each sub field -->
                        </md-list>


                    </div><!-- [formGroupName]="i" -->

                  </td></tr><!-- ngFor="let singleSubRecord -->

                </table><!-- formArrayName="{{field['name']}}"-->
            </td></tr><!-- show sub fields -->

            <tr><td><!-- show sub fields -->
              <button 
                md-raised-button
                (click)="addSubFieldL1(field['name'], 
                docForm['controls'][field['name']]['controls'])"
                title="Add New in {{field['title']}}"
              >Add New in {{field['title']}}</button>
            </td></tr><!-- show sub fields -->

          </table><!-- show sub fields -->
          </span><!-- fields to ignore -->

        </td></tr><!-- *ngFor="let field of fields[0]" --><!-- all fields -->


        <tr><td><!-- all fields -->
          <button
            md-raised-button
            type="submit"
            [disabled]="!docForm.valid"
          >Add Record</button>
          <button
            md-raised-button
            [routerLink]="['/cocs/list']" 
          >Cancel</button>
          <button
            md-raised-button
            type="reset" 
          >Reset</button>
        </td></tr><!-- all fields -->

      </table><!-- all fields -->
    </form>
  </md-card-content>
</md-card>