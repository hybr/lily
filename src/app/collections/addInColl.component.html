
<div class="lns_loading" *ngIf="!(docOfCocs | async)">Loading add form...</div>
<md-card *ngIf="(docOfCocs | async)">

  <md-card-header>
    <md-card-title><h2>Adding New {{(docOfCocs|async)?.name}} Record</h2></md-card-title>
    <md-card-subtitle>{{(docOfCocs|async)?.detail}}</md-card-subtitle>
  </md-card-header>

  <md-card-content>

<form 
      *ngIf="(docOfCocs | async)" 
      [formGroup]="docForm" 
      novalidate  
      (ngSubmit)="onSubmit(docForm)" 
      [hidden]="submitted"
    >
      <md-list>
        <md-list-item>
            <md-select placeholder="Status" formControlName="active">
              <md-option value="false">Inactive</md-option>
              <md-option value="true" selected=selected>Active</md-option>
          </md-select>
        </md-list-item>

        <md-list-item *ngFor="let field of fields[0]">

          <div *ngIf="(field['name'] != 'active')"><!-- fields to ignore -->

              <div *ngIf="(field['type'] != 'fields')"><!-- main fields -->

                <md-input-container *ngIf="(field['type'] == 'string')">
                  <input 
                    mdInput 
                    placeholder="{{field['title']}}" 
                    type="text" 
                    formControlName="{{field['name']}}"
                    id="addInCollField{{field['name']}}Id"
                  />
                </md-input-container>

                <md-input-container *ngIf="(field['type'] == 'number')">
                  <input 
                    mdInput 
                    placeholder="{{field['title']}}" 
                    type="number" 
                    formControlName="{{field['name']}}"
                    id="addInCollField{{field['name']}}Id"
                  />
                </md-input-container>

                <md-input-container *ngIf="(field['type'] == 'date')">
                  <input 
                    mdInput 
                    placeholder="{{field['title']}}" 
                    type="date" 
                    formControlName="{{field['name']}}"
                    id="addInCollField{{field['name']}}Id"
                  />
                </md-input-container>

              </div><!-- main fields -->

              <div *ngIf="(field['type'] == 'fields')" class="ui-field-contain"><!-- show sub fields -->

                <hr /><fieldset>
                  <legend>{{field['title']}}</legend>
                  <div><!--  add button -->
                    <span (click)="addSubFieldL1(field['name'], docForm['controls'][field['name']]['controls'])"
                      title="Add New {{field['title']}}">
                      Add New {{field['title']}}
                    </span>
                  </div><!-- add button -->

                  <div formArrayName="{{field['name']}}">
                    <div 
                      *ngFor="
                        let singleSubRecord of docForm['controls'][field['name']]['controls']; 
                        let i = index; 
                      "
                    >
                      <div [formGroupName]="i" class="lns_sub_fields_border"><!-- [formGroupName]="i" -->

                        <div><!--  remove button -->
                          <span (click)="removeSubFieldL1(i, field['name'])">
                            Remove {{i + 1}}
                          </span>
                        </div><!-- remove button -->

                        <div *ngFor="let subField of field['value']" ><!-- each sub field -->
                         
                          <md-input-container *ngIf="(subField['type'] == 'string')">
                            <input 
                              mdInput 
                              placeholder="{{subField['title']}}" 
                              type="text" 
                              formControlName="{{subField['name']}}"
                              id="addInCollField{{subField['name']}}Id"
                            />
                          </md-input-container>

                          <md-input-container *ngIf="(subField['type'] == 'number')">
                            <input 
                              mdInput 
                              placeholder="{{subField['title']}}" 
                              type="number" 
                              formControlName="{{subField['name']}}"
                              id="addInCollField{{subField['name']}}Id"
                            />
                          </md-input-container>

                          <md-input-container *ngIf="(subField['type'] == 'date')">
                            <input 
                              mdInput 
                              placeholder="{{subField['title']}}" 
                              type="date" 
                              formControlName="{{subField['name']}}"
                              id="addInCollField{{subField['name']}}Id"
                            />
                          </md-input-container>


                        </div><!-- each sub field -->
                      </div><!-- [formGroupName]="i" -->
                    </div><!-- ngFor="let singleSubRecord -->
                </div><!-- formArrayName-->

              </fieldset>

            </div><!-- show sub fields -->
          
          </div><!-- fields to ignore -->
        
        </md-list-item><!-- *ngFor="let field of fields[0]" -->

        <md-list-item>
          <button
            type="submit"
            class="ui-btn ui-shadow ui-btn-inline ui-corner-all ui-icon-action ui-btn-icon-left"
            [disabled]="!docForm.valid"
          >Add</button>
          <button 
            [routerLink]="['/cocs']" 
            class="ui-btn ui-shadow ui-btn-inline ui-corner-all ui-icon-arrow-l ui-btn-icon-left"
          >Cancel</button>
          <button 
            type="reset" 
            class="ui-btn ui-shadow ui-btn-inline ui-corner-all ui-icon-recycle ui-btn-icon-left"
          >Reset</button>
        </md-list-item>
      </md-list>

    </form>
  </md-card-content>
</md-card>
  