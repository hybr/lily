<div class="lns_loading" *ngIf="!(docOfCocs | async)">Loading add record form...</div>

<md-card *ngIf="(docOfCocs | async)"><!-- L1 -->
  <md-card-header>
    <md-card-title><h2>Add {{(docOfCocs|async)?.f3.v}} Record</h2></md-card-title>
    <md-card-subtitle><p>{{(docOfCocs|async)?.f4.v}} Record</p></md-card-subtitle>
  </md-card-header>

  <tr><td><!-- L1, R4 -->
    <form #cocsForm="ngForm" novalidate>

      <table><!-- L2 Form -->
        <tr *ngFor=" let fieldNameL2 of recordStructure['sorted_field_names']; let rsCountL2 = index; "><td><!-- L2 Form, R1 -->
          

          <md-input-container *ngIf="recordStructure[fieldNameL2]['type'] != 'obj'">
            <input 
              mdInput  
              placeholder="{{ recordStructure[fieldNameL2]['title'] }}" 
              type="text"
              value="{{ recordStructure[fieldNameL2]['default_value'] }}"
              name="{{ fieldNameL2 }}"
              [(ngModel)]="recordValues[fieldNameL2]['v']"
              id="addInCollField{{ fieldNameL2 }}Id"
            />
          </md-input-container>


          <table *ngIf="recordStructure[fieldNameL2]['type'] == 'obj'"><!-- L3 Sub Fields -->

            <tr *ngFor=" let fieldNameL3 of recordStructure[fieldNameL2]['sorted_field_names']; let rvCountL3 = index; "
              class="lns_sub_fields_border"
            ><td><!-- L3 Sub Fields, R1 -->


                  <div><!--  remove button -->
                    <button md-raised-button (click)="removeSubFieldL1(rsCountL2, field['name'])">
                      Remove {{rsCountL2+1}}
                    </button>
                  </div><!-- remove button -->


                  
            <fieldset><!-- sub field is obj -->
              <legend>{{field['title']}}</legend>

            Record Value Count {{rvCountL3}}

              <span >
                
                <md-input-container>
                  <input 
                    mdInput  
                    placeholder="{{ recordStructure [fieldNameL2] ['v'] [fieldNameL3] ['title'] }}" 
                    type="text"
                    value="{{ recordStructure[fieldNameL2]['default_value'] }}"
                    name="{{ fieldNameL2 }}"
                    [(ngModel)]="recordValues[fieldNameL2]['v']"
                    id="addInCollField{{ fieldNameL2 }}Id"
                  />
                </md-input-container>

              </span>

              </fieldset>

            </td></tr><!-- L3 Sub Fields, R1 --><!-- for each value of record -->


          </table><!-- L3 Sub Fields -->




        </td></tr><!-- L2 Form, R1 -->
      </table><!-- L2  Form -->

    </form>
  </td></tr><!-- L1, R4 -->

  <tr><td><!-- L1, R2 -->
    <hr />Record Values = <pre>{{ recordValues | json }}</pre>
  </td></tr><!-- L1, R2 -->

  <tr><td><!-- L1, R2 -->
    <hr />Record Structure (Modified Collection Structure) = <pre>{{ recordStructure | json }}</pre>
  </td></tr><!-- L1, R2 -->
  
  <tr><td><!-- L1, R1 -->
    <hr />Record of Cocs (Collection Structure) = <pre>{{ docOfCocs | async | json }}</pre>
  </td></tr><!-- L1, R1 -->

</md-card><!-- L1 -->