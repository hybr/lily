<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<div>

	<div *ngFor="let fieldStructure of valuesOfList(fieldGroupStructure)">
		
		<span *ngIf="isVariableObject(fieldStructure)"> 

			<button md-button (click)="removeValue(fieldStructure['_n'])">
				Remove {{fieldStructure['_n']}}
			</button>


			<button *ngIf="(tableNumber == tableOfTables)" md-button (click)="showProperty=!showProperty">Properties</button>

			<fieldset *ngIf="!fieldStructure['_f']">

				<legend>{{fieldStructure['_t']}}</legend>

				<div *ngIf="fieldStructure['_m'] != undefined && fieldStructure['_m'] > 0">

					<div class="lns_sub_fields_border" >

						<app-db-group-field	
							[tableNumber]="tableNumber"
							[fieldGroupValues]="applyFieldValue(fieldGroupValues, fieldStructure['_n'])"
							[fieldGroupStructure]="applyFieldValue(fieldGroupStructure, fieldStructure['_n'])"
							(groupFieldValueIsUpdated)="updateFieldGroupValue(fieldStructure['_n'], $event, 'GFC1')"
							(groupFieldStructureIsUpdated)="updateFieldGroupStructure(fieldStructure['_n'], $event, 'GFC2')"
						></app-db-group-field>

					</div>

				</div>

				<div *ngIf="fieldStructure['_m'] == undefined || fieldStructure['_m'] == 0">

					<app-db-group-field	
						[tableNumber]="tableNumber"
						[fieldGroupValues]="applyFieldValue(fieldGroupValues, fieldStructure['_n'])"
						[fieldGroupStructure]="applyFieldValue(fieldGroupStructure, fieldStructure['_n'])"
						(groupFieldValueIsUpdated)="updateFieldGroupValue(fieldStructure['_n'], $event, 'GFC3')"
						(groupFieldStructureIsUpdated)="updateFieldGroupStructure(fieldStructure['_n'], $event, 'GFC4')"
					></app-db-group-field>

				</div>

			</fieldset>

			<span *ngIf="!fieldStructure['_f']">
				<br /><hr />
			</span>

			<div *ngIf="fieldStructure['_f']">

				<div *ngIf="fieldStructure['_m'] != undefined && fieldStructure['_m'] > 0">

					<app-db-field
						[fieldValue]="applyFieldValue(fieldGroupValues, fieldStructure['_n'])"
						[fieldProperties]="applyFieldValue(fieldGroupStructure, fieldStructure['_n'])"
						(fieldIsUpdated)="updateFieldValue(fieldStructure['_n'], $event, 'GHC5')"
						(fieldPropertiesIsUpdated)="updateFieldProperties(fieldStructure['_n'], $event, 'GFC6')"
						[foreignKeyCollectionName]="fieldStructure['_o']"
						[foreignKeyTitleFields]="fieldStructure['_i']"
					></app-db-field>

				</div>

				<div *ngIf="fieldStructure['_m'] == undefined || fieldStructure['_m'] == 0">

					<app-db-field
						[fieldValue]="applyFieldValue(fieldGroupValues, fieldStructure['_n'])"
						[fieldProperties]="applyFieldValue(fieldGroupStructure, fieldStructure['_n'])" 
						(fieldIsUpdated)="updateFieldValue(fieldStructure['_n'], $event, 'GFC7')"
						(fieldPropertiesIsUpdated)="updateFieldProperties(fieldStructure['_n'], $event, 'GFC8')"
						[foreignKeyCollectionName]="fieldStructure['_o']"
						[foreignKeyTitleFields]="fieldStructure['_i']"						
					></app-db-field>

				</div>

			</div>

			<app-db-field-property 
				*ngIf="showProperty"
				[fieldProperties]="applyFieldValue(fieldGroupStructure, fieldStructure['_n'])" 
				(fieldPropertiesIsUpdated)="updateFieldProperties(fieldStructure['_n'], $event, 'GFC9')"
			></app-db-field-property>

		</span>

	</div>

</div>

<span *ngIf="isVariableEmpty(fieldGroupStructure) && (tableNumber == tableOfTables)">
	<button md-button (click)="addNewField(fieldGroupValues, fieldGroupStructure)">Add First Field</button>
</span>

<span *ngIf="(!isVariableEmpty(fieldGroupStructure)) && (tableNumber == tableOfTables)">
	<button md-button (click)="addNewField(fieldGroupValues, fieldGroupStructure)">Add Next Field</button>
</span>